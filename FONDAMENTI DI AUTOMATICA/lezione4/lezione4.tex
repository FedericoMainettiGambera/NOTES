\newpage
\title{LEZIONE 4 16/03/2020}\newline
[RICOPIO APPUNTI PRESI DALLE SLIDE DEL PROF, registrazione persa] \newline
\textbf{Update:} Trovata registrazione di backup! \newline
\textbf{link} \href{https://onedrive.live.com/?authkey=%21AATVJK3srNwxGzs&id=EE092FF4FF7B5B0E%212158&cid=EE092FF4FF7B5B0E}{Link a una registrazione di back up}
\section{Linearizzazione di sistemi dinamici non lineari (SD, NL, SISO, TC) nell'intorno di un equilibrio}
Consideriamo un sistema dinamico non lineare (TI):
\[
    S: \begin{cases}
        \dot{x} = f(x,u)\\
        y = h(x,u)
    \end{cases}
\]
e un suo equilibrio $(\bar{u}, \bar{x}, \bar{y})$.\newline
\newline
Volgiamo determinare un sistema dinamico lineare tempo invariante che approssimi il comportamento di $S$ nell'intorno dell'equilibrio, cioè finchè $u(t)$, $x(t)$ e $y(t)$ non si discostano "troppo" dai valori $\bar{u}$, $\bar{x}$ e $\bar{y}$ di equilibrio.
\subsection{Per l'equazione di stato}
Consideriamo \textbf{l'equazione di stato} e sviluppiamola in serie fermandoci al primo ordine:
\[
    d(\bar{x} + \delta x, \bar{u} + \delta u) = \cancel{ f(\bar{x} \bar{u})} + f_x|_{\bar{x}, \bar{u}}\delta x + f_0|_{\bar{x}, \bar{u}} \delta u (+ \dots)
\]
dove
\begin{itemize}
    \item $\delta x$ e $\delta u$ rappresentano gli scostamenti di $x$ e di $u$ rispetto all'equilibrio;
    \item $f(\bar{x}, \bar{u})$ vale $0$ perchè $\bar{x}$ è stato di equilibrio per $u = \bar{u}$:
    \item $f_x$ è la derivata parziale rispetto a $x$ della funzionei $f$: $\frac{\delta f}{\delta x}$;
    \item $(+ ...)$ indica i termini di ordine superiore dello sviluppo.
\end{itemize}
\[
    \frac{d}{dt} (\bar{x} + \delta x) = \frac{d}{dt} (\delta x) = \delta \dot{x} = \; \text{derivata temporale dello scostamento di $x$ rispetto all'equilibrio}\;
\]
\[
    \dot{x} = f(x,u) \;\;\;\;\;\;\;\; x = \bar{x} + dx \;\;\;\;\;\;\;\; \dot{x} = \delta \dot{x} \;\;\;\;\;\;\;\; 0 = \tau + \delta u
\]
\[
    \delta \dot{x} = f_x|_{\bar{x}, \bar{u}} \delta x + f_u |_{\bar{x}, \bar{u}} \delta u
\]
Equazione di stato lineare, alle variazioni $\Longrightarrow$ Equazione di stato del sistema linearizzato.
\subsection{Per l'equazione d'uscita}
Consideriamo ora \textbf{l'equazione d'uscita} $y = g(x,u)$ e come prima sviluppiamola in serie fermandoci al primo ordine:
\[
    g(\bar{x} + \delta x , \bar{u} + \delta u) = g(\bar{x}, \bar{u}) + g_x|_{\bar{x}, \bar{u}} \delta x + g_u |_{\bar{x}, \bar{u}} \delta u (+ ...)
\]
dove
\begin{itemize}
    \item $g(\bar{x} + \delta x , \bar{u} + \delta u)$ è $g(x,u)$, cioè $y$;
    \item $g(\bar{x}, \bar{u})$ è $y$;
    \item $(+ ...)$ indica i termini di ordine superiore dello sviluppo.
\end{itemize}
\[
    y - \bar{y} = g_x|_{\bar{x}, \bar{u}} \delta x + g_u |_{\bar{x}, \bar{u}} \delta u \Longrightarrow \delta y = g_x|_{\bar{x}, \bar{u}} \delta x + g_u |_{\bar{x}, \bar{u}} 
\]
\subsection{Sistema linearizzato nell'intorno dell'equilibrio $\bar{u}, \bar{x}, \bar{y}$}
\[
    \mathcal{L}^S : \begin{cases}
        \delta \dot{x} = f_x |_{\bar{x},\bar{u}} \delta x + f_0|_{\bar{x},\bar{u}} \delta u\\
        \delta y = g_x|_{\bar{x},\bar{u}} \delta x + g_u |_{\bar{x},\bar{u}} \delta u
    \end{cases}
\]
con $ \delta u = u - \bar{u}$, $\delta x = x -\bar{x}$, $ \delta y = y - \bar{y}$.
\subsection{Interpretazione}
[immagine dagli appunti del prof]
\newpage
\section{Stabilità}
\subsection{Equilibrio}
Il concetto di stabilità si applica solitamente agli equilibri, ma a volta anche a movimenti, e qualche volta ai sistemi.\newline
\newline
\textbf{Equilibrio stabile}:\newline
Sia $\bar{x}$ uno stato di equilibrio del SD generico $\dot{x} = f(x,u)$ per $u = \bar{u}$ costante, si dice equilibrio stabile se
\[
    \;\forall\; \epsilon > 0 \;\; \exists \; \delta > 0 \;\;:\;\; |x(0) - \bar{x}| < \delta \Rightarrow  |x(t) - \bar{x}| < \epsilon \;\;\;\forall\;t \geq 0
\]
Interpretazione con $x$ scalare:\newline
[immagine dagli appunti del prof]\newline
\newline
\textbf{Equilibrio asintoticamente stabile (AS)}:\newline
L'equilibrio deve essere stabile e inoltre deve valere
\[
    |x(t) - \bar{x}| \rightarrow 0  \;per \; t \rightarrow \infty
\]
\newline
\textbf{Equilibrio instabile}:\newline
In tutti gli altri casi.
\subsection{Stabilità nei SD LTI a TC}
$\dot{x} = Ax + bu$\newline
Sia $\bar{x}$ uno stato di eq. per $u = \bar{u}$\newline
Allora
\[
    \begin{rcases}
        x(0) &= \bar{x}\\
        u(t) &= \bar{u} \;\;\; t\geq 0
    \end{rcases} \rightarrow  x(t) = \bar{x} \;\;\;t \geq 0
\]
Quindi
\[
    x(t) = e^{At} \bar{x} + \int_{0}^{t}e^{A(t-\tau)} b \bar{u} d \tau = \bar{x}
\]
Consideriamo ora il movimento perturbato 
\[
    x_{\Delta}(t) = e^{At}(\bar{x} + \Delta \bar{x}) + \int_{0}^{t}e^{A(t- \tau)}b \bar{u} d \tau
\]
Quindi 
\[
    x_\Delta (t) - \bar{x} = e^{At} \Delta \bar{x}
\]
dove notiamo che la maniera in cui $x_\Delta$ di muove rispetto a $\bar{x}$ non dipende dal particolare $\bar{x}$ che al secondo membro non compare.\newline
\newline
Tutti gli equilibri (se ve ne sono) hanno le stesse caratteristiche di stabilità.\newline
Quindi nei sistemi lineari (TI) la stabilità è una proprietà del sistema.\newline
In tal caso la stabilità del sistema dipende soltanto dal comportamento di $e^{At}$, cioè dalla matrice $A$.\newline
\newline
\textbf{es.}  Sistema LTI a TC di ordine 1:\newline
$\dot{x} = a x$, con $a$ scalare e equilibrio $\bar{x} = 0$.\newline
$x(0) = \Delta \bar{x}$\newline
$x(t) = e^{at} \Delta \bar{x}$ $\Rightarrow $ $\begin{cases}
    a < 0 \;\;\;\; & x(t) \rightarrow  0 = \bar{x} \;\text{eq. AS}\;\\
    a = 0 \;\;\;\; & x(t) = \Delta \bar{x} \;\text{eq. S}\;\\
    a > 0 \;\;\;\; & x(t) \;\text{diverse}\;\;\;\text{eq- I}\;
\end{cases}$\newline
\newline
\rule{\textwidth}{0,4pt}\newline
\textbf{Riassunto:}\newline
Quindi 
\begin{itemize}
    \item $e^{At} \rightarrow  =_{nxn}$ per $t \rightarrow  \infty$ $\Longrightarrow$ sistema AS (ML di $x \rightarrow  0$);
    \item $e^{At}$ diverge per $t \rightarrow  \infty$ $\Longrightarrow$ sistema I (ML di $x$ diverge salvo eccezzioni);
    \item $e^{At}$ non $\rightarrow  0$ e non diverge per $t \rightarrow  \infty$ $\Longrightarrow$ sistema S.
\end{itemize}
\rule{\textwidth}{0,4pt}
\subsection{Proprietà dei SD LTI a TC AS}
\begin{itemize}
    \item i ML di $x$ e di $y$ tendono a $0$ per $t \rightarrow  \infty$, quindi tali SD "dimenticnao lo stato iniziale";
    \item Se 
    \[
        u(t) = \begin{cases}
            \text{qualsiasi segnale}\; \;\; & t< \bar{t}\\
            0 & t \geq \bar{t}
        \end{cases}
    \]
    allora per $t \geq \bar{t}$ c'è solo ML e quindi $x,y \rightarrow 0$ per $t \rightarrow \infty$.
\end{itemize}
\subsection{Stabilità di un SD LTI a TC e matrice A}
Cosa in cui $A$ è diagonalizzabile (se no vedi più avanti):
$x_L (t) = e^{At} x(0) = e^{T diag\{\lambda_i\}T^{-1} t}x(0) = T diag\{e^{\lambda_i t}\}T^{-1}x(0)$, dove $x_L(t)$ è ML di $x$, T è la matrice che diagonalizza $A$ e $e^{\lambda_it}$ prende il nome di modi del sistema.\newline
\newline
Se $A$ è reale, allora $\lambda_i$ sono o reali o coppie complesse coniugate.\newline
ML $\rightarrow  0$ per ogni $x(0)$ vuol dire che tutti i modi devono tendere a $0$ per $t \rightarrow \infty$.
\begin{itemize}
    \item $\lambda_i \; \text{reale}$
    \[
        \begin{cases}
            \lambda_i >0 \;\;& \text{modo divergente}\;\\
            \lambda_i =0 \;\;& \text{modo costante}\;\\
            \lambda_i <0 \;\;& \text{modo}\;\rightarrow  0
        \end{cases}
    \]
    \item $\lambda_{h,k} = \alpha \pm i \beta \;\;\;\text{coppia complessa coniugata, con $\alpha$ e $\beta$ reali}\;$, implica che $e^{()\alpha \pm i \beta)t} = e^{\alpha t} \cancel{sin(\beta t) + i cos(\beta t)}$ [perchè $sin(\beta t) + i cos(\beta t)$ è limitata] e quindi
    \[
        \begin{cases}
            Re(\lambda) < 0 \;\; & \text{modo convergente}\;\\
            Re(\lambda) = 0 \;\; & \text{modo limitato ma non tendente a $0$}\;\\
            Re(\lambda) > 0 \;\; & \text{modo divergente}\;
        \end{cases}
    \]
\end{itemize}
\subsection{Stabilità e autovalori di $A$}
Tutti gli autovalori di $A$ hanno $Re <0$ $\Longleftrightarrow$ Sistema AS.\newline
\newline
Almeno un autovalore di $A$ ha $Re > 0$ $\Longrightarrow$ Sistema I.\newline
\newline
Tutti gli autovalori di $A$ hanno $Re \leq 0$ e ne esiste almeno uno con $Re = 0$ $\Longrightarrow$ Sistema S, ma non AS; oppure sistema I.
\subsection{Caso a TD (A diagonalizzabile)}
$x_L(k) = A^k x(0)$\newline
$A^k = (T diag\{\lambda_i\} T^{-1})^k = T diag\{\lambda_i\}\cancel{T^{-1}T} diag\{\lambda_i\} T^{-1} \dots$ (k volte) $= T diag\{\lambda_i^k\}T^{-1}$, dove $\lambda_i^{k}$ sono i modi del sistema.\newline
\newline
Quindi
\begin{itemize}
    \item $|\lambda_i| < 1$ $\;\forall\;i$ $\longleftrightarrow$ sistema AS.
    \item $\;\;\exists\;\; i \;\;:\;\; |\lambda_i| > 1$ $\Longrightarrow$ sistema I.
    \item $\begin{cases}
        |\lambda_i| \leq 1 \;\;\forall\; i\\
        \;\;\exists\;\;i \;\;:\;\;|\lambda_i| = 1 
    \end{cases}$ $\Longrightarrow$ Sistema S, ma non AS, oppure sistema I.
\end{itemize}
\textbf{oss.1} Errore tipico: Nel caso a tempo continuo si guarda la parte reale degli autovalori, nel caso a tempo discreto di guarda il modulo (!) degli autovalori.\newline
\textbf{oss.2} Errore tipico: Più avanti vedremo il criterio di Routh, ma da notare è che non vale per i sistemi a tempo discreto, vale solo per sistemi a tempo continuo (!).
\subsection{Criteri di stabilità (asintotica) per SD LTI a TC}
Domanda: data la matrice $A$, posso dire se tutti i suoi autovalori hanno o meno $Re <0$ senza calcolarli?\newline
\newline
Sì, vi sono criteri per dirlo basati sull'ispezione di $A$ o del suo polinomio caratteristico (PC) $\Pi(s) = det (sI-A)$:
\begin{itemize}
    \item $det(A) = \Pi_{i=1}^{n}S_i$, dove con $S_i$ si intendono gli autovalori $\Longrightarrow$ se $det(A) = 0$ esiste $S_i = 0$ $\Longrightarrow$ sistema non AS.
    \item $tr(A) = \sum_{i=1}^{n}S_i$ $\Longrightarrow$ se $tr(A) >0$ esiste $S_i$ tale che $Re(S_i) > 0$ $\Longrightarrow$ sistema I.
    \item Se $Re(S_i)<0$ per ogni $i$ (cioè se il sistema è AS), allora i coefficienti di $\Pi(S)$ sono tutti concordi e non nulli (n.b. il viceversa vale solo per polinomi del secondo ordine).
\end{itemize}
\ \newline