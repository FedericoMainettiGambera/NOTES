\title{LEZIONE 3 12/03/2020}\newline
\textbf{link} \href{https://web.microsoftstream.com/video/0f5f35c0-ba36-4f9c-a496-057ebab138ec?list=user&userId=faa91214-a6f5-40d7-8875-253fd49b8ce1}{clicca qui}
\subsection{Sistemi dinamici (SD) lineari tempo invarianti (LTI)}
I sistemi dinamici \textbf{lineari tempo invarianti} sono sistemi in cui $f$ e $g$ sono lineari in $x$ e in $u$, e per cui non c'è dipendenza esplicita da $t$ (TC) o da $k$ (TD).\newline
\newline
Li vedremo solo SISO (single input, single output).\newline
\newline
Cominciamo per il caso a \textbf{tempo continuo} (TC). L'unico modo per avere un sistema dinamico a tempo continuo lineare tempo invariante (SD TC LTI) è il seguente:
\[
    \begin{cases}
        \dot{x}_1(t) &= a_{11}x_1(t) + \dots+ a_{1n}x_{n}(t) + b_1 u(t)\\
        \dots &= \;\;\; \dots\\
        \dot{x}_n(t) &= a_{n1}x_1(t) +\dots+ a_{nn}x_n(t) + b_nu(t)\\
        y(t) &= c_1x_1(t) + \dots + c_n x_n(t) + d u(t)
    \end{cases}
\]
In forma vettoriale:
\[
    x = \left[\begin{matrix}
        x_1\\
        \dots\\
        x_n
    \end{matrix}\right], \;\;\; A = \left[\begin{matrix}
        a_{11} & \dots & a_{1n}\\
        \dots & \dots & \dots\\
        a_{n1} & \dots & a_{nn}
    \end{matrix}\right], \;\;\; b = \left[\begin{matrix}
        b_1\\
        \dots\\
        b_n
    \end{matrix}\right], \;\;\; c = [c_1 \;\; \dots \;\; c_n]
\]
\[
    \begin{cases}
        \dot{x} = Ax+bu\\
        y = cx +du
    \end{cases}
\]
I termini $A, b, c, d$ prendono il nome di \textbf{descrizione di stato}.\newline
\newline
Il caso a \textbf{tempo discreto} (TD) è analogo.
\[
    \begin{cases}
        x(k) = Ax(k-1) + bu(k-1)\\
        y(k) = cx(k) +d u(k)
    \end{cases}
\] 
\textbf{oss.} Nei libri di testo si può trovare scritto così: $\begin{cases}
    x(k+1) = Ax(k) + bu(k)\\
    y(k+1) = cx(k+1) +d u(k+1)
\end{cases}$, comunque sia scritta, cià che importa è che nella prima equazione del sistema ci siano due valori successivi di $k$ (quello corrente e quello successivo oppure quello corrente e quello precedente) e nella seconda ci sia un solo valore di $k$ (stesso valore consistente, che sia quello corrente, quello successivo o quello precedente, etc.).
\newpage
\section{Equilibrio}
\subsection{Definizione}
Poniamoci una domanda:
\[
    \begin{rcases}
        x(0) &= \bar{x}\\
        u(t) \;\text{(o $u(k)$)}\; &= \bar{u} \;\;\text{per $t$ (o $k$) $\geq 0$}\;
    \end{rcases} \rightarrow x(t) \;\text{(o $x(k)$)}\; = \bar{x} \;\;\;\;\text{per $t$ (o $k$) maggiore di 0}\;
\]
Cioè: con un ingresso costante deciso ($u(t)$ (o $u(k)$) $=\bar{u}$ costante), esiste un qualche stato costante ($\bar{x}$ costante) tale che, prendendo proprio questo stato come stato iniziale e applicando l'ingresso costante deciso, lo stato non cabia?\newline
\newline
\textbf{oss.} Il concetto di equilibrio è che se si pone un sistema in uno stato di equilibrio, lui rimane lì. Da notare è che la stabilità è un altra cosa: se "sposto" il sistema dallo stato di stabilità, il sistema tende a ritornare lì.
\subsection{Calcolo degli equilibri}
Vediamo il caso a \textbf{tempo continuo} (TC). Se $x$ deve rimanere costante, significa che la derivata deve essere nulla $\dot{x} = 0$. Quindi in generale con $\dot{x} = f(x,u)$, noto il valore $\bar{u}$ segnato che applico, gli eventuali $\bar{x}$ sono le soluzioni di $f(\bar{x}, \bar{u}) = 0$.\newline
\newline
Vediamo il caso a \textbf{tempo discreto} (TD). Se $x$ deve rimanere costante, significa che $x(k+1) = x(k)$ per ogni $k$, cioè $x(k+1)$ deve rimanere costante. Quindi in tal caso dovrò risolvere per $\bar{x}$ l'equazione $f(\bar{x}, \bar{u}) = \bar{x}$.\newline
\newline
Vediamo ora il caso \textbf{tempo continuo} (TC) \textbf{lineare tempo invariante} (LTI) (per sistemi non lineari guardare l'osservazione più avanti). In questo caso l'equazione da risolvere diventa $0 = A \bar{x} + b \bar{u}$ (risolvendo questo sistema matriciale si trovano i vari stati di equilibrio). Se $A$ non è singolare, allora esiste uno e uno solo $\bar{x} = -A^{-1} b u$, altrimenti o non esiste $\bar{x}$ o esistono infiniti $\bar{x}$.\newline
\newline
Vediamo ora il caso \textbf{tempo discreto} (TD) \textbf{lineare tempo invariante} (LTI). In questo caso l'equazione da risolvere diventa $\bar{x} = A \bar{x} + b \bar{u}$. Questa equazione si scrive anche $(I-A)\bar{x} = b \bar{u}$ e se $I-A$ non è singolare, cioè se $A$ non ha autovalori in 1, allora esiste uno e uno solo $\bar{x} = (I-A)^{-1} b \bar{u}$, altrimenti o non esiste $\bar{x}$ o esistono infiniti valori $\bar{x}$.\newline
\newline
\textbf{oss.} Nel \textbf{caso non lineare} $g(\bar{x}, \bar{u})$ potrebbe anche non avere significato, quindi non esiste un'uscita d'equilibrio. Invece nel caso lineare (sia TC sia TD) se esiste $\bar{x}$, allora esiste sempre $\bar{y} = c \bar{x} + d \bar{u}$.\newline
\newline
Se esiste un $\bar{x}$ (cioè se un sistema ammette un certo stato di equilibrio) per un certo $u = \bar{u}$, in generale esiste un \textbf{uscita di equilibrio} $\bar{y} = g(\bar{x}, \bar{u})$.
\subsection{Esempi}
\textbf{es.} Esempio della massa-molla visto la lezione scorsa:\newline
L'equazione che governa il sistema è $m \ddot{y} = F - ky - h \dot{y}$, con $u = F$, ed eravamo arrivati a dire che $\begin{cases}
    \dot{x}_1 = x_2\\
    \dot{x}_2 = - \frac{k}{m}x_1 - \frac{h}{m}x_2 + \frac{1}{m}u\\
    y = x_1
\end{cases}$, con $x_1$ posizione e $x_2$ velocità.\newline
Riscriviamo il tutto in forma matriciale:
\[
    \begin{cases}
        \left[\begin{matrix}
            \dot{x}_1\\
            \dot{x}_2
        \end{matrix}\right] = \left[\begin{matrix}
            0 \;\; &1\\
            - \frac{k}{m} \;\;& - \frac{h}{m}
        \end{matrix}\right] \left[\begin{matrix}
            x_1\\
            x_2
        \end{matrix}\right] + \left[\begin{matrix}
            0 \\
            \frac{1}{m}
        \end{matrix}\right] u\\
        y = \left[\begin{matrix}
            1 \;\;0
        \end{matrix}\right] \left[\begin{matrix}
            x_1\\
            x_2
        \end{matrix}\right]
    \end{cases}
\]
Ponendo $u = \bar{u}$ esiste un equilibrio $\bar{x}$?\newline
Pongo $\dot{x}_1 = 0$ $\Longrightarrow$ $\bar{x}_2 = 0$, ovvio perchè la velocità è nulla all'equilibrio.\newline
Pongo $\dot{x}_2 = 0$, quindi $- \frac{k}{m} \bar{x}_1 - \cancel{ \frac{h}{m}\bar{x}_2} + \frac{1}{m}\bar{u} = 0$ $\Longrightarrow$ $\bar{x}_1 = \frac{\bar{u}}{k}$.\newline
\newline
\textbf{es.} Esempio del pendolo visto la lezione scorsa:\newline
Avevamo posto $x_1 = \theta$ e $x_2 = \dot{\theta}$. Andando a rivedere le equazioni che governano questo sistema che abbiamo scritto la volta scorsa si arriva ad avere $\begin{cases}
    \dot{x}_1 = x_2\\
    \dot{x}_2 = - \frac{g}{l} sin(x_1) - \frac{h}{ml^2} x_2 + \frac{1}{ml^2}u
\end{cases}$.\newline
Ponendo $u = \bar{u}$ esiste un equilibrio $\bar{x}$?\newline
Pongo $\dot{x}_1= 0$ $\Longrightarrow$ $x_2 = 0$, ovvio perchè la velocità angolare è nulla all'equilibrio.\newline
Pongo $\dot{x}_2$ $\Longrightarrow$ $0 = - \frac{g}{l}sin(\bar{x}_1) + \frac{1}{ml^2} \bar{u}$.\newline
Il risultato è che $\begin{cases}
    \bar{x}_1 = arcsin(\frac{\bar{u}}{mgl})\\
    \bar{x}_2 = 0
\end{cases}$ e quindi:
\begin{itemize}
    \item  se $|\bar{u}| > mgl$, non esiste equilibrio $\bar{x}$, e il pendolo continua a girare.
    \item  se $\bar{u} = 0$, allora abbiamo due soluzioni: $\bar{x}_1 = 0$ o $\bar{x}_1 = \pi$ (sono due equilibri).
\end{itemize}
\newpage
\section{Movimento}
\subsection{Definizione}
\[
    \begin{rcases}
        \text{uno stato iniziale}\; x(0)\\
        \text{un ingresso}\; u(t) \;\text{(o $u(k)$)} \;\;\text{per $t$ (o $k$) $\geq 0$}\;
    \end{rcases} \rightarrow \text{producono}\; x(t) \;\text{(o $x(k)$)}\; \text{e un}\;y(t) \;\text{(o $y(k)$)}\; 
\]
Questi $x(t) \;\text{(o $x(k)$)} \;\text{e}\;y(t) \;\text{(o $y(k)$)}$ prendono il nome di \textbf{movimenti di stato e uscita}.
\subsection{Formule di Lagrange (TD LTI)}
\subsubsection{Caso a tempo discreto (TD) lineare tempo invariante (LTI)}
Studiamo il caso \textbf{tempo discreto} (TD) \textbf{lineare tempo invariante} (LTI):\newline
\[
    \begin{cases}
        x(k) = A x(k-1) + b u(k-1)\\
        y(k) = cx(k) + dx(k)
    \end{cases}
\]
Vediamo cosa succede se imponiamo un $x(0)$ e un $u(k)$ con $k\geq 0$.\newline
\newline
Calcoliamo il movimento dello stato $x$:\newline
$x(0)$ è il dato di partenza, \newline
$x(1) = Ax(0) + bu(0)$, \newline
$x(2) = A x(1) + bu(1) = A^2 x(0) + Abu(0) + bu(1)$,\newline
$\dots$\newline
Quinidi per il generico $k$ possiamo scrivere la \textbf{formula di Lagrange a tempo discreto per lo stato}
\[
    x(k) = A^kx(0) + \sum_{l=0}^{k-1}A^{k-l-1}bu(l)
\]
dove il termine
\[
    A^k x(0)
\]
è il \textbf{movimento libero (ML) dello stato} e il termine 
\[
    \sum_{l=0}^{k-1}A^{k-l-1}bu(l)
\]
è il \textbf{movimento forzato (MF) dello stato}.\newline
\newline
\textbf{oss.}  ML dipende linearmente solo dallo stato iniziale $x(0)$ e non dall'ingresso $u(k)$, MF dipende linearmente solo dall'ingresso $u(k)$ e non dallo stato iniziale $x(0)$.\newline
\newline
\textbf{oss.}  ML e MF sommati danno il movimento totale, vale quindi il \textbf{principio di sovrapposizione degli effetti (PSE)}.\newline
\newline
\textbf{oss.} Se il sistema non è lineare, in genere non si riesce a separare il movimento in ML e MF. \newline
\newline
Calcoliamo il movimento dell'uscita $u$:\newline
Analogamente si giunge alla \textbf{formula di Lagrange a tempo discreto per l'uscita}:
\[
    y(k) = cx(k) + du(k) = c A^k x(0) + c \sum_{l=0}^{k-1}A^{k-l-1}bu(l) + du(k)
\]
dove il termine
\[
    c A^k x(0)
\]
è il \textbf{movimento libero (ML) dell'uscita} e il termine
\[
    c \sum_{l=0}^{k-1}A^{k-l-1}bu(l) + du(k)
\]
è il \textbf{movimento forzato (MF) dell'uscita}.
\subsubsection{Caso a tempo continuo (TC) lineare tempo invariante (LTI)}
Vediamo il caso \textbf{tempo continuo} (TC) \textbf{lineare tempo invariante} (LTI).\newline
\textbf{Formula di Lagrange a tempo continuo per lo stato}
\[
    x(t) = e^{At}x(0) + \int_{0}^{t}e^{A(t-\tau)}bu(\tau)d \tau
\]
dove il termine
\[
    e^{At}x(0)
\] è il \textbf{movimento libero (ML) dello stato} e il termine
\[
    \int_{0}^{t}e^{A(t-\tau)}bu(\tau)d \tau
\] è il \textbf{movimento forzato (MF) dello stato}.\newline
\newline
\textbf{Formula di Lagrange a tempo continuo per l'uscita}
\[
    y(t) = c e^{At}x(0) + c\int_{0}^{t}e^{A(t-\tau)}bu(\tau)d \tau + du(t)
\]
dove il termine
\[
    ce^{At}x(0)
\]
è il \textbf{movimento libero (ML) dell'uscita} e il termine
\[
    c\int_{0}^{t}e^{A(t-\tau)}bu(\tau)d \tau + du(t)
\] 
è il \textbf{movimento forzato (MF) dell'uscita}.
\subsection{Esempi}
\textbf{es.} Movimento a TC:\newline
siano\newline
$\dot{x} = -2x$ (solo ML dello stato) e $x(0) = 4$\newline
Che cosa è $x(t)$ per $t\geq 0$?\newline
Applicando la formula otteniamo: $x(t) = e^{At}x(0) = e^{-2t}4$\newline
\newline
\textbf{es.} Da risolvere a casa!\newline
Siano $\dot{x} = Ax$, con $A = \left[\begin{matrix}
    1&1\\
    2&1
\end{matrix}\right]$ e $x(0) = \left[\begin{matrix}
    3\\
    4
\end{matrix}\right]$, allora come è $x(t)$ per $t\geq 0$?\newline
[il professore lo risolve con Maxima]
\subsection{Esponenziale di matrice}
Per sistemi a tempo continuo lineari tempo invarianti di ordine maggiore di $1$, nel calcolo dei movimenti dello stato e dell'uscita occorre calcolare l'esponenziale di matrice $e^{At}$.\newline
\newline
Vediamo come fare per il caso in cui $A$ sia \textbf{diagonalizzabile} (cioè se il numero di autovalori contati con la loro molteplicità è pari all'ordine della matrice e se la molteplicità geometrica di ciascun autovalore coincide con la relativa molteplicità algebrica; notiamo che una matrice quadrata di ordine n che ammette esattamente n autovalori distinti è sicuramente diagonalizzabile), altrimenti il movimento non è calcolabile con l'esponenziale di matrice e quindi si userà un altro approccio, che incontreremo più avanti.
\subsubsection{Dimostrazione}
Definizioni e concetti importanti:
\begin{itemize}
    \item Data una matrice $M$, scriviamo $e^M = I + M + \frac{M^2}{2!} + \frac{M^3}{3!}+\dots$.
    \item Se $M$ è diagonalizzabile, allora esiste una matrice $T^{-1}$ (non singolare) tale che $T^{-1} M T = D$ è una matrice diagonale tale che i suoi elementi sulla diagonale sono gli autovalori $\lambda_i$ di $M$. Di conseguenza $M = T D T^{-1}$.\newline
    (\textbf{oss.} $T$ è la matrice degli autovettori accostati, $T^{-1}$ si ricava da $T$, e la matrice diagonale $D$ ha lungo la sua diagonale gli autovalori nell'ordine corrispondente agli autovettori di $T$).
\end{itemize}
Quindi unendo questi due concetti posso scrivere
\[
    e^M = I + M + \frac{M^2}{2!} + \frac{M^3}{3!}+\dots=
\]
\[
    = TT^{-1} + T D T^{-1} + \frac{TD\cancel{T^{-1} T}DT^{-1}}{2!} + \frac{TD \cancel{T^{-1} T}D \cancel{T^{-1} T}DT^{-1}}{3!} + \dots =
\]
\[
    = TT^{-1} + T D T^{-1} + \frac{TD^2T^{-1}}{2!} + \frac{TD^3T^{-1}}{3!} + \dots=
\]
[dove $TT^{-1} = I$. Ora raccogliendo ottengo]
\[
    = T(I + D + \frac{D^2}{2!} + \frac{D^3}{3!} + \dots)T^{-1} = T e^{D}T^{-1}
\]
ma siccome $D = \left[\begin{matrix}
    \lambda_1 \;\; &0 \;\; &0\\
    0 & \dots &0\\
    0 &0 & \lambda_n
\end{matrix}\right]$, allora elevando $D$ a un generico indice $k$, otteniamo $D^k= \left[\begin{matrix}
    \lambda_1^k \;\; &0 \;\; &0\\
    0 & \dots &0\\
    0 &0 & \lambda_n^k
\end{matrix}\right]$.\newline
Di conseguenza $T e^{D}T^{-1} = T \left[\begin{matrix}
    e^{\lambda_1} \;\; &0 \;\; &0\\
    0 & \dots &0\\
    0 &0 & e^{\lambda_n}
\end{matrix}\right] T^{-1}$.\newline
Tornando alla nostra matrice $A$ (diagonalizzabile), 
\[
    e^{At}= e^{TD_AT^{-1}t} =
\] 
[con $D_A = T^{-1} A T$ diagonale (cioè la matrice $A$ diagonalizzata). Porre molta \textbf{attenzione} alla posizione dei $T$ e $T^{-1}$, è un errore molto gettonato all'esame.]
\[
    = T(It + D_A t + \frac{(D_at)^2}{2!} + \dots)T^{-1} =  T \left[\begin{matrix}
        e^{\lambda_1t} \;\; &0 \;\; &0\\
        0 & \dots &0\\
        0 &0 & e^{\lambda_nt}
    \end{matrix}\right]T^{-1}
\] con $\lambda_i$ autovalore i-esimo di $A$, gli autovalori $e^{\lambda_it}$ prendono il nome di \textbf{modi del sistema}.
\subsubsection{Metodo pratico}
I passaggi per calcolare un generico esponenziale di matrice $e^{At}$ da seguire sono:
\begin{itemize}
    \item calcolare gli autovalori di $A$;
    \item calcolcare gli autovettori corrispondenti per ogni autovalore di $A$;
    \item definire la matrice diagonalizzante $T$ come l'accostamento degli autovettori (e ricordarsi l'ordine) e, una volta determinato $T$, calcolare la sua inversa $T^{-1}$;
    \item notare che $T^{-1} A T = D =$ matrice con gli autovalori di $A$ lungo la diagonale nell'ordine in cui compaiono gli autovettori in $T$;
    \item $e^{At}= e^{T D T^{-1} t}$ (notare l'ordine con cui sono scritti $T$ e $T^{-1}$, un errore tipico è confondersi in questo punto)
    \item $e^{At} = T e^{D t} T^{-1} = T \left[\begin{matrix}
        e^{\lambda_1 t} & 0 & \dots & 0\\
        0 & e^{\lambda_2 t} & \dots & \dots\\
        \dots & \dots & \dots & 0\\
        \dots & \dots & 0 & e^{\lambda_n t}
    \end{matrix}\right] T^{-1}$, fare i conti e fine.
\end{itemize}